<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh Thiếp Kỹ Thuật Số</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            overflow-x: hidden;
        }

        /* --- CẤU TRÚC 3D & LẬT THẺ --- */
        .perspective-1000 {
            perspective: 1000px;
        }
        
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
            transform-style: preserve-3d;
            cursor: pointer;
        }

        .card-inner.is-flipped {
            transform: rotateY(180deg);
        }

        /* --- STYLE CHO CÁC MẶT THẺ --- */
        .card-face {
            position: absolute; 
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 0.5rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            background-color: white;
            overflow: hidden;
            -webkit-backface-visibility: hidden; 
            backface-visibility: hidden;
        }

        .card-front {
            z-index: 2;
        }

        .card-back {
            transform: rotateY(180deg);
            z-index: 1;
        }

        .ambient-glow {
            background: linear-gradient(to right, #a5f3fc, #d9f99d, #fef08a);
            opacity: 0.6;
            filter: blur(60px);
        }

        /* --- ANIMATION TEXT --- */
        @keyframes text-breathe {
            0%, 100% { opacity: 0.4; transform: scale(0.95); }
            50% { opacity: 1; transform: scale(1); }
        }

        .instruct-text {
            animation: text-breathe 2s infinite ease-in-out;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 text-gray-900">

    <!-- Hiệu ứng nền (Glow) -->
    <div class="fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[300px] md:w-[500px] h-[300px] ambient-glow rounded-full -z-10 pointer-events-none"></div>

    <!-- Khu vực thẻ -->
    <div class="perspective-1000 w-full max-w-[420px] h-[250px]">
        <div class="card-inner" id="cardInner" onclick="toggleFlip()">
            
            <!-- MẶT TRƯỚC (Front) -->
            <div class="card-face card-front flex flex-col items-center justify-center p-6">
                <!-- Avatar -->
                <div class="mb-5 relative">
                    <div class="absolute inset-0 rounded-full bg-gradient-to-tr from-cyan-400 via-lime-400 to-yellow-400 blur-[2px]"></div>
                    <div class="relative bg-white p-[3px] rounded-full">
                        <img id="avatar" src="" alt="Avatar" class="w-24 h-24 rounded-full object-cover shadow-sm">
                    </div>
                </div>

                <!-- Thông tin chính -->
                <h2 id="display-name" class="text-3xl font-bold text-gray-900 tracking-tight">Loading...</h2>
                <p id="display-role" class="text-cyan-600 font-semibold text-sm mt-1">...</p>
                <p id="display-company" class="text-gray-500 text-xs mt-1.5 font-medium">...</p>

                <!-- Thanh màu trang trí -->
                <div class="h-2.5 w-full flex absolute bottom-0 left-0 right-0">
                    <div class="h-full w-1/3 bg-yellow-400"></div>
                    <div class="h-full w-1/3 bg-lime-400"></div>
                    <div class="h-full w-1/3 bg-cyan-500"></div>
                </div>
            </div>

            <!-- MẶT SAU (Back) -->
            <div class="card-face card-back flex flex-col p-6">
                
                <!-- Header nhỏ -->
                <div class="text-center mb-4">
                    <h3 id="back-name" class="text-lg font-bold text-gray-900">Loading...</h3>
                    <p id="back-role" class="text-cyan-600 text-[10px] font-semibold uppercase tracking-wide">...</p>
                </div>

                <!-- Grid thông tin -->
                <div class="grid grid-cols-2 gap-x-3 gap-y-4 px-1 text-left">
                    <!-- Phone -->
                    <div class="flex items-center space-x-2 group cursor-pointer" onclick="event.stopPropagation(); document.getElementById('link-phone').click();">
                        <div class="w-7 h-7 rounded-full bg-blue-50 flex items-center justify-center flex-shrink-0 group-hover:bg-blue-100 transition">
                            <svg class="w-3.5 h-3.5 text-gray-600 group-hover:text-blue-600 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                        </div>
                        <div class="overflow-hidden">
                            <p class="text-[8px] text-gray-400 font-bold uppercase">Mobile</p>
                            <a id="link-phone" href="#" onclick="event.stopPropagation()" class="text-[11px] font-semibold text-gray-800 truncate block group-hover:text-cyan-600 transition">...</a>
                        </div>
                    </div>

                    <!-- Website -->
                    <div class="flex items-center space-x-2 group cursor-pointer" onclick="event.stopPropagation(); document.getElementById('link-website').click();">
                        <div class="w-7 h-7 rounded-full bg-lime-50 flex items-center justify-center flex-shrink-0 group-hover:bg-lime-100 transition">
                            <svg class="w-3.5 h-3.5 text-gray-600 group-hover:text-lime-600 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path></svg>
                        </div>
                        <div class="overflow-hidden">
                            <p class="text-[8px] text-gray-400 font-bold uppercase">Website</p>
                            <a id="link-website" href="#" target="_blank" onclick="event.stopPropagation()" class="text-[11px] font-semibold text-gray-800 truncate block group-hover:text-cyan-600 transition">...</a>
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="flex items-center space-x-2 group cursor-pointer" onclick="event.stopPropagation(); document.getElementById('link-email').click();">
                        <div class="w-7 h-7 rounded-full bg-yellow-50 flex items-center justify-center flex-shrink-0 group-hover:bg-yellow-100 transition">
                            <svg class="w-3.5 h-3.5 text-gray-600 group-hover:text-yellow-600 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                        </div>
                        <div class="overflow-hidden">
                            <p class="text-[8px] text-gray-400 font-bold uppercase">Email</p>
                            <a id="link-email" href="#" onclick="event.stopPropagation()" class="text-[11px] font-semibold text-gray-800 truncate block group-hover:text-cyan-600 transition">...</a>
                        </div>
                    </div>

                    <!-- Address -->
                    <div class="flex items-center space-x-2 group cursor-pointer" onclick="event.stopPropagation(); document.getElementById('link-address').click();">
                        <div class="w-7 h-7 rounded-full bg-gray-100 flex items-center justify-center flex-shrink-0 group-hover:bg-gray-200 transition">
                            <svg class="w-3.5 h-3.5 text-gray-600 group-hover:text-red-500 transition" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        </div>
                        <div class="overflow-hidden">
                            <p class="text-[8px] text-gray-400 font-bold uppercase">Office</p>
                            <a id="link-address" href="#" target="_blank" onclick="event.stopPropagation()" class="text-[11px] font-semibold text-gray-800 truncate block leading-tight group-hover:text-cyan-600 transition">...</a>
                        </div>
                    </div>
                </div>

                <!-- Footer: Socials -->
                <div class="mt-auto flex items-end justify-between px-1 pt-2">
                    <div class="flex space-x-3 text-gray-500">
                        <a id="btn-linkedin" href="#" target="_blank" onclick="event.stopPropagation()" class="hover:text-blue-600 transition-colors" title="LinkedIn">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z"></path><circle cx="4" cy="4" r="2"></circle></svg>
                        </a>
                        <a id="btn-facebook" href="#" target="_blank" onclick="event.stopPropagation()" class="hover:text-blue-500 transition-colors" title="Facebook">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"></path></svg>
                        </a>
                        <a id="btn-instagram" href="#" target="_blank" onclick="event.stopPropagation()" class="hover:text-pink-600 transition-colors" title="Instagram">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="2" y="2" width="20" height="20" rx="5" ry="5" stroke-width="2"></rect><path d="M16 11.37A4 4 0 1112.63 8 4 4 0 0116 11.37z" stroke-width="2"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5" stroke-width="2"></line></svg>
                        </a>
                    </div>
                    
                    <!-- Nút Save Contact -->
                    <div class="flex flex-col items-end">
                        <button id="btn-save" onclick="saveContact(event)" class="bg-gray-900 text-white px-3 py-1.5 rounded text-[10px] font-medium flex items-center space-x-1.5 hover:bg-black transition-colors shadow-lg active:scale-95 transform">
                            <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg>
                            <span id="btn-save-text">Save Contact</span>
                        </button>
                    </div>
                </div>

                <div class="h-2.5 w-full flex absolute bottom-0 left-0 right-0 rounded-b-sm overflow-hidden">
                    <div class="h-full w-1/3 bg-yellow-400"></div>
                    <div class="h-full w-1/3 bg-lime-400"></div>
                    <div class="h-full w-1/3 bg-cyan-500"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hướng dẫn -->
    <div class="mt-12 mb-10 z-10 pointer-events-none select-none text-center">
        <p class="instruct-text text-gray-400 text-[11px] font-bold tracking-[0.3em] uppercase">
            Tap to Flip
        </p>
    </div>
    
    <div class="text-gray-400 text-xs">
        <p>© 2025 Designed by You</p>
    </div>

    <!-- SCRIPT LOGIC -->
    <script>
        const cardData = {
            firstName: "Hùng",
            lastName: "Nguyễn Hữu",
            role: "Software Engineer",
            company: "ID Creative Solutions",
            phone: "+84 879 332 174",
            email: "hung.nguyen@idhouse.vn",
            website: "www.id-creative.com",
            address: "123 Creative Blvd, Design City",
            avatarUrl: "https://ik.imagekit.io/3xpzbwtjm/avatar",
            socials: {
                linkedin: "https://www.linkedin.com/in/your-profile",
                facebook: "https://www.facebook.com/your-profile",
                instagram: "https://www.instagram.com/your-profile"
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            const fullName = `${cardData.firstName} ${cardData.lastName}`;
            const avatarSrc = cardData.avatarUrl ? cardData.avatarUrl : `https://ui-avatars.com/api/?name=${fullName.replace(' ', '+')}&background=f3f4f6&color=333&size=128&bold=true`;

            document.getElementById('avatar').src = avatarSrc;
            document.getElementById('display-name').textContent = fullName;
            document.getElementById('display-role').textContent = cardData.role;
            document.getElementById('display-company').textContent = cardData.company;
            document.getElementById('back-name').textContent = fullName;
            document.getElementById('back-role').textContent = cardData.role;
            
            document.getElementById('link-phone').textContent = cardData.phone;
            document.getElementById('link-phone').href = `tel:${cardData.phone.replace(/\s+/g, '')}`;
            
            document.getElementById('link-website').textContent = cardData.website;
            document.getElementById('link-website').href = `https://${cardData.website}`;
            
            document.getElementById('link-email').textContent = cardData.email;
            document.getElementById('link-email').href = `mailto:${cardData.email}`;
            
            const addressElement = document.getElementById('link-address');
            addressElement.textContent = cardData.address;
            addressElement.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(cardData.address)}`;

            document.getElementById('btn-linkedin').href = cardData.socials.linkedin;
            document.getElementById('btn-facebook').href = cardData.socials.facebook;
            document.getElementById('btn-instagram').href = cardData.socials.instagram;
        });

        function toggleFlip() {
            document.getElementById('cardInner').classList.toggle('is-flipped');
        }

        // --- HÀM LƯU CONTACT: GOOGLE CONTACTS TARGETING ---
        function saveContact(event) {
            event.stopPropagation();
            
            const isAndroid = /Android/i.test(navigator.userAgent);
            const fullName = `${cardData.firstName} ${cardData.lastName}`;

            // Hàm tạo file vCard dự phòng
            const downloadVCard = () => {
                const vCardData = [
                    'BEGIN:VCARD', 'VERSION:3.0',
                    `N:${cardData.lastName};${cardData.firstName};;;`,
                    `FN:${cardData.firstName} ${cardData.lastName}`,
                    `ORG:${cardData.company}`,
                    `TITLE:${cardData.role}`,
                    `TEL;TYPE=CELL:${cardData.phone}`,
                    `EMAIL;TYPE=WORK,INTERNET:${cardData.email}`,
                    `URL:${cardData.website}`,
                    `ADR;TYPE=WORK:;;${cardData.address}`,
                    `X-SOCIALPROFILE;type=linkedin:${cardData.socials.linkedin}`,
                    `X-SOCIALPROFILE;type=facebook:${cardData.socials.facebook}`,
                    'END:VCARD'
                ].join('\n');

                const encoded = encodeURIComponent(vCardData);
                const url = `data:text/vcard;charset=utf-8,${encoded}`;
                
                const link = document.createElement('a');
                link.href = url;
                link.setAttribute('target', '_self');
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            };

            if (isAndroid) {
                // Thử gọi đúng ứng dụng Google Contacts
                // com.google.android.contacts là package chuẩn trên Pixel/Samsung
                const intentUrl =
                    `intent:#Intent;` +
                    `action=android.intent.action.INSERT;` +
                    `type=vnd.android.cursor.dir/contact;` +
                    `S.name=${encodeURIComponent(fullName)};` +
                    `S.phone=${encodeURIComponent(cardData.phone)};` +
                    `S.email=${encodeURIComponent(cardData.email)};` +
                    `S.company=${encodeURIComponent(cardData.company)};` +
                    `S.job_title=${encodeURIComponent(cardData.role)};` +
                    `S.postal=${encodeURIComponent(cardData.address)};` +
                    `package=com.google.android.contacts;` + // <-- ĐỔI THÀNH GÓI GOOGLE
                    `end`;

                // Gọi Intent
                window.location.href = intentUrl;

                // FALLBACK: Đặt hẹn giờ, nếu sau 1s mà Intent thất bại (không chuyển app)
                // thì tự động tải file xuống. Đây là lưới an toàn.
                setTimeout(() => {
                    // Kiểm tra xem trang có bị ẩn đi không (nghĩa là đã chuyển app thành công chưa)
                    if (!document.hidden) {
                        console.log("Intent failed or user stayed on page. Fallback to download.");
                        downloadVCard();
                    }
                }, 1000);
                
                return;
            }

            // iOS / Desktop: Gọi hàm download luôn
            downloadVCard();
        }
    </script>
</body>
</html>
